{"version":3,"file":"4.js","sources":["webpack:///./api/user.js","webpack:///./pages/settings/index.vue?6f95","webpack:///./pages/settings/index.vue","webpack:///./pages/settings/index.vue?1982","webpack:///./pages/settings/index.vue?79a7"],"sourcesContent":["import { request } from '@/plugins/request'\r\n\r\n//用户登陆\r\nexport const login = data => {\r\n    return request({\r\n        method:\"POST\",\r\n        url:\"/api/users/login\",\r\n        data\r\n    })\r\n}\r\n\r\n//用户注册\r\nexport const register = data => {\r\n    return request({\r\n        method:\"POST\",\r\n        url:\"/api/users\",\r\n        data\r\n    })\r\n}\r\n\r\nexport const updateUser = data => request(\"/api/user\", {\r\n    method: \"PUT\",\r\n    data\r\n  })","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"settings-page\"},[_vm._ssrNode(\"<div class=\\\"container page\\\"><div class=\\\"row\\\"><div class=\\\"col-md-6 offset-md-3 col-xs-12\\\"><h1 class=\\\"text-xs-center\\\">Your Settings</h1> <ul class=\\\"error-messages\\\">\"+(_vm._ssrList((_vm.errors),function(messages,field){return ((_vm._ssrList((messages),function(message,index){return (\"<li>\"+_vm._ssrEscape(_vm._s(field +\" \"+ message))+\"</li>\")})))}))+\"</ul> <form><fieldset\"+(_vm._ssrAttr(\"disabled\",_vm.submitting))+\"><fieldset class=\\\"form-group\\\"><input type=\\\"text\\\" placeholder=\\\"URL of profile picture\\\"\"+(_vm._ssrAttr(\"value\",(_vm.user.image)))+\" class=\\\"form-control\\\"></fieldset> <fieldset class=\\\"form-group\\\"><input type=\\\"text\\\" placeholder=\\\"Your Name\\\"\"+(_vm._ssrAttr(\"value\",(_vm.user.username)))+\" class=\\\"form-control form-control-lg\\\"></fieldset> <fieldset class=\\\"form-group\\\"><textarea rows=\\\"8\\\" placeholder=\\\"Short bio about you\\\" class=\\\"form-control form-control-lg\\\">\"+_vm._ssrEscape(_vm._s(_vm.user.bio))+\"</textarea></fieldset> <fieldset class=\\\"form-group\\\"><input type=\\\"text\\\" placeholder=\\\"Email\\\"\"+(_vm._ssrAttr(\"value\",(_vm.user.email)))+\" class=\\\"form-control form-control-lg\\\"></fieldset> <fieldset class=\\\"form-group\\\"><input type=\\\"password\\\" placeholder=\\\"Password\\\"\"+(_vm._ssrAttr(\"value\",(_vm.user.password)))+\" class=\\\"form-control form-control-lg\\\"></fieldset> <button class=\\\"btn btn-lg btn-primary pull-xs-right\\\">Update Settings</button> <button class=\\\"btn btn-outline-danger\\\"> Or click here to logout. </button></fieldset></form></div></div></div>\")])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport { updateUser } from \"@/api/user\";\r\nimport { mapActions } from \"vuex\";\r\nexport default {\r\n//访问:没登录不能访问\r\n  middleware: \"authenticated\",\r\n  data() {\r\n    return { errors: {}, submitting: false };\r\n  },\r\n  asyncData({ store }) {\r\n    const user = store.state.user;\r\n    const formData = {};\r\n    for (const key of [\"email\", \"username\", \"password\", \"image\", \"bio\"]) {\r\n      formData[key] = user[key];\r\n    }\r\n    return { user: formData };\r\n  },\r\n  methods: {\r\n    ...mapActions([\"clientSetUser\"]),\r\n    async onSubmit() {\r\n      this.submitting = true;\r\n      try {\r\n        const {\r\n          data: { user },\r\n        } = await updateUser({ user: this.user });\r\n        this.clientSetUser(user);\r\n        this.errors = {};\r\n        this.$router.push({\r\n          name: \"profile-username\",\r\n          params: { username: user.username },\r\n        });\r\n      } catch (error) {\r\n        this.errors = error.response.data.errors;\r\n      }\r\n      this.submitting = false;\r\n    },\r\n\r\n    logout () {\r\n        this.$router.push('/login')\r\n    }\r\n  }\r\n}\r\n","import mod from \"-!../../node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js??ref--2-0!../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/_babel-loader@8.2.2@babel-loader/lib/index.js??ref--2-0!../../node_modules/_vue-loader@15.9.6@vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=3de78470&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nfunction injectStyles (context) {\n  \n  \n}\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/_vue-loader@15.9.6@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  null,\n  \"cc30ab92\"\n  \n)\n\nexport default component.exports"],"mappings":";;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AAHA;AAKA;AACA;AAEA;AACA;AACA;AACA;AACA;AAHA;AAKA;AAEA;AACA;AACA;AAFA;;;;;;;;;;;;ACpBA;AACA;AACA;;;;;;;;;;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AADA;AAEA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAFA;AAIA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAvBA;AAdA;;ACtEA;;;;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}